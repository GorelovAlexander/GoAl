#!/usr/bin/env python
# coding: utf-8

#   <div class="alert alert-info">
#   –ü—Ä–∏–≤–µ—Ç, –ê–ª–µ–∫—Å–∞–Ω–¥—Ä! –ú–µ–Ω—è –∑–æ–≤—É—Ç –°–≤–µ—Ç–ª–∞–Ω–∞ –ß–∏—Ö –∏ —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç. –ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ—é –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ. –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—â–∞—Ç—å—Å—è –Ω–∞ ¬´—Ç—ã¬ª. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —É–¥–æ–±–Ω–æ - –¥–∞–π –∑–Ω–∞—Ç—å, –∏ –º—ã –ø–µ—Ä–µ–π–¥–µ–º –Ω–∞ ¬´–≤—ã¬ª.
# 
#   <div class="alert alert-success">
#   <b>üëç –£—Å–ø–µ—Ö:</b> –ó–µ–ª—ë–Ω—ã–º —Ü–≤–µ—Ç–æ–º –æ—Ç–º–µ—á–µ–Ω—ã —É–¥–∞—á–Ω—ã–µ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.
#   </div>
#   <div class="alert alert-warning">
#   <b>ü§î –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</b> –ñ—ë–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º –≤—ã–¥–µ–ª–µ–Ω–æ —Ç–æ, —á—Ç–æ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É. –¢—ã –º–æ–∂–µ—à—å —É—á–µ—Å—Ç—å —ç—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—É–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∏–ª–∏ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Å–µ–π—á–∞—Å (–æ–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ).
#   </div>
#   <div class="alert alert-danger">
#   <b>üòî –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</b> –ö—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º –≤—ã–¥–µ–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö, —è –Ω–µ —Å–º–æ–≥—É –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–æ–µ–∫—Ç :(
#   </div>
#   <div class="alert alert-info">
#   <b>üëÇ –°–æ–≤–µ—Ç:</b> –ö–∞–∫–∏–µ-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
#   </div>
#   –î–∞–≤–∞–π —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –¥–∏–∞–ª–æ–≥–µ: –µ—Å–ª–∏ —Ç—ã —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø–æ –º–æ–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º ‚Äî –ø–∏—à–∏ –æ–± —ç—Ç–æ–º.
#   –ú–Ω–µ –±—É–¥–µ—Ç –ª–µ–≥—á–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —Ç—ã –≤—ã–¥–µ–ª–∏—à—å —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
#   <div class="alert alert-info"> <b>üéì –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫.</div>
#   –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –í—Å—ë —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã—Å—Ç—Ä–µ–µ.
#    </div>

#   <div class="alert alert-info"> <b>üéì –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –°–≤–µ—Ç–ª–∞–Ω–∞, –∑–¥—Ä–∞–≤—Å—Ç–≤—É–π! –ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ —Ä–µ–≤—å—é –ø—Ä–æ–µ–∫—Ç–∞. –ë—É–¥—É –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ –∑–∞–º–µ—á–∞–Ω–∏—è.</div>

# # –ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç: —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
# 
# # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
# 
# –û–ø–µ—Ä–∞—Ç–æ—Ä —Å–≤—è–∑–∏ ¬´–¢–µ–ª–µ–î–æ–º¬ª —Ö–æ—á–µ—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å –æ—Ç—Ç–æ–∫–æ–º –∫–ª–∏–µ–Ω—Ç–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–∞—á–Ω—É—Ç –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥—ã –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –≤—Å–µ–º, –∫—Ç–æ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç —É—Å–ª—É–≥ —Å–≤—è–∑–∏. –ß—Ç–æ–±—ã –∑–∞—Ä–∞–Ω–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ç–∞–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, ¬´–¢–µ–ª–µ–î–æ–º—É¬ª –Ω—É–∂–Ω–∞ –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å, —Ä–∞–∑–æ—Ä–≤—ë—Ç –ª–∏ –∞–±–æ–Ω–µ–Ω—Ç –¥–æ–≥–æ–≤–æ—Ä. –ö–æ–º–∞–Ω–¥–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Å–æ–±—Ä–∞–ª–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏—Ö —Ç–∞—Ä–∏—Ñ–∞—Ö –∏ —É—Å–ª—É–≥–∞—Ö.
# 
# –û–ø–µ—Ä–∞—Ç–æ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞ —É—Å–ª—É–≥: 
# 
# - –°—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—É—é —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—É—é —Å–≤—è–∑—å. –¢–µ–ª–µ—Ñ–æ–Ω –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ª–∏–Ω–∏—è–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ; 
# - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–≤—É—Ö —Ç–∏–ø–æ–≤: —á–µ—Ä–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—É—é –ª–∏–Ω–∏—é (DSL) –∏–ª–∏ –æ–ø—Ç–æ–≤–æ–ª–æ–∫–æ–Ω–Ω—ã–π –∫–∞–±–µ–ª—å (Fiber optic).
# 
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏:
# 
# - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –∞–Ω—Ç–∏–≤–∏—Ä—É—Å (DeviceProtection) –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ (OnlineSecurity);
# - –í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (TechSupport);
# - –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (OnlineBackup);
# - –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤–æ–µ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ (StreamingTV) –∏ –∫–∞—Ç–∞–ª–æ–≥ —Ñ–∏–ª—å–º–æ–≤ (StreamingMovies).
# 
# –ö–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –ø–ª–∞—Ç–∏—Ç—å –∑–∞ —É—Å–ª—É–≥–∏ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü –∏–ª–∏ –∑–∞–∫–ª—é—á–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä –Ω–∞ 1‚Äì2 –≥–æ–¥–∞. –í–æ–∑–º–æ–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å —Å—á—ë—Ç —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π —á–µ–∫.
# 
# **–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞** 
# 
# –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É—é—â—É—é –≤–æ–∑–º–æ–∂–Ω—ã–π –æ—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤.
# 
# **–ó–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞**
# - –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
# - –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏—Ç–æ–≥–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–µ–±—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
# - –ø—Ä–æ–≤–µ—Å—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑—ã
# - –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏ –æ–±—É—á–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏
# - –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à—É—é –º–æ–¥–µ–ª—å
# - –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# 
# **–¶–µ–ª–µ–≤–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ** 
# 
# –ó–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ roc_auc –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å >= 0.85.

# ## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

# –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

# In[1]:


get_ipython().system('pip install pandas -q')
get_ipython().system('pip install matplotlib -q')
get_ipython().system('pip install phik -q')
get_ipython().system('pip uninstall scikit-learn -y')
get_ipython().system('pip install scikit-learn==1.3.2')


# In[60]:


import pandas as pd
import warnings
warnings.simplefilter("ignore") 
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
from scipy import stats as st
import sklearn
import phik
from datetime import (datetime as dt, 
                      date, 
                      time)
from functools import reduce
from phik.report import plot_correlation_matrix

from sklearn.model_selection import (train_test_split, 
                                     GridSearchCV, 
                                     RandomizedSearchCV,
                                     cross_val_score)
from sklearn.preprocessing import (OneHotEncoder, 
                                   OrdinalEncoder, 
                                   StandardScaler, 
                                   MinMaxScaler, 
                                   PolynomialFeatures, 
                                   RobustScaler,
                                   LabelEncoder)
from sklearn.linear_model import LinearRegression, LogisticRegression
from sklearn.pipeline import Pipeline
from sklearn.compose import ColumnTransformer
from sklearn.impute import SimpleImputer
from sklearn.tree import DecisionTreeClassifier, DecisionTreeRegressor
from sklearn.svm import SVC
from sklearn.metrics import (roc_auc_score, 
                             accuracy_score, 
                             confusion_matrix, 
                             mean_squared_error, 
                             mean_absolute_error, 
                             r2_score,
                             make_scorer,
                             RocCurveDisplay)
from catboost import CatBoostClassifier


# –í–≤–æ–¥–∏–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã.

# In[3]:


RANDOM_STATE = 80925
TEST_SIZE = 0.25


# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω—É–∂–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
# </div>

# ## –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# –°–æ–∑–¥–∞–¥–∏–º –¥–∞—Ç–∞—Å–µ—Ç—ã –∏ —É–∫–∞–∂–µ–º –≤ –Ω–∏—Ö –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.

# In[4]:


contract = pd.read_csv('/datasets/contract_new.csv')
personal = pd.read_csv('/datasets/personal_new.csv')
internet = pd.read_csv('/datasets/internet_new.csv')
phone = pd.read_csv('/datasets/phone_new.csv')


# –í—ã–≤–µ–¥–µ–º –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

# In[5]:


display(contract.head())
print(contract.info())
print()
display(personal.head())
print(personal.info())
print()
display(internet.head())
print(internet.info())
display(phone.head())
print(phone.info())


# **–í—ã–≤–æ–¥—ã –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö**
# 
# - –î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
# - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —á–∏—Å–ª–∞ –∏ –¥–∞—Ç—ã –∑–∞–ø–∏—Å–∞–Ω—ã —Ç–∏–ø–æ–º object (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∏—Ç—å)
# - –ë—É–ª–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã —Å–ª–æ–≤–∞–º–∏ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π)
# - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö
# - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–æ–ª–±–µ—Ü —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å) 

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω—ã!
# </div>

# ## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# –ò–∑–º–µ–Ω–∏–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —Ç–∞–º, –≥–¥–µ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.

# In[6]:


contract['TotalCharges'] = pd.to_numeric(contract['TotalCharges'], errors='coerce')
contract['BeginDate'] = pd.to_datetime(contract['BeginDate'], format='%Y-%m-%d')


# –°–æ–∑–¥–∞–¥–∏–º —Å—Ç–æ–ª–±–µ—Ü —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ EndDate. –î–ª—è —ç—Ç–æ–≥–æ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞.

# In[7]:


print(contract['EndDate'].unique())


# –ú–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –¥–≤–∞ –≤–∏–¥–∞ –¥–∞–Ω–Ω—ã—Ö: –¥–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –∏ **No**, –µ—Å–ª–∏ –¥–æ–≥–æ–≤–æ—Ä –Ω–µ –±—ã–ª –∑–∞–≤–µ—Ä—à–µ–Ω. –ò–°—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º **target**, –≥–¥–µ 1 –æ–∑–Ω–∞—á–∞–µ—Ç –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç (No), –∞ 0 - –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç.

# In[8]:


contract['target'] = [1 if i != 'No' else 0 for i in contract['EndDate']]


# –ü—Ä–æ–≤–µ—Ä–∏–º —Å—Ç–æ–ª–±–µ—Ü —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º.

# In[9]:


contract.head(10)


# –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–≤–µ—Å—Ç–∏ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∫ datetime –≤ —Å—Ç–æ–ª–±—Ü–µ EndDate –∏–∑–º–µ–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ No –Ω–∞ –¥–∞—Ç—É, –∫–æ–≥–¥–∞ –±—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ - 1 —Ñ–µ–≤—Ä–∞–ª—è 2020 –≥–æ–¥–∞.

# In[10]:


contract.loc[(contract['EndDate'] == 'No'),'EndDate'] = '2020-02-01'


# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
# </div>

# –ò–∑–º–µ–Ω–∏–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç–æ–ª–±—Ü–µ EndDate –Ω–∞ datetime.

# In[11]:


contract['EndDate'] = pd.to_datetime(contract['EndDate'],format= "%Y/%m/%d")


# –¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–≤–µ–¥–µ–Ω—ã –∫ –ø–æ–¥—Ö–æ–¥—è—â–∏–º —Ç–∏–ø–∞–º, –ø—Ä–æ–≤–µ—Ä–∏–º –¥–∞—Ç–∞—Å–µ—Ç—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

# In[12]:


print(contract.duplicated().sum())
print(personal.duplicated().sum())
print(internet.duplicated().sum())
phone.duplicated().sum()


# –í—ã–≤–µ–¥–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è–º —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –≤–æ –≤—Å–µ—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞ –æ–ø–µ—á–∞—Ç–∫–∏.

# In[13]:


unique_values = contract['Type'].unique()
print(unique_values)
unique_values = contract['PaymentMethod'].unique()
print(unique_values)
unique_values = personal['gender'].unique()
print(unique_values)
unique_values = internet['InternetService'].unique()
print(unique_values)


# –û–ø–µ—á–∞—Ç–æ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ. –í—ã–≤–¥–µ–º–µ –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö –µ—â—ë —Ä–∞–∑, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.

# In[14]:


display(contract.head())
print(contract.info())
print()
display(personal.head())
print(personal.info())
print()
display(internet.head())
print(internet.info())
display(phone.head())
print(phone.info())


# **–í—ã–≤–æ–¥—ã –ø–æ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö**
# 
# - –ß–∏—Å–ª–∞ –∏ –¥–∞—Ç—ã –±—ã–ª–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ –Ω—É–∂–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö
# - –°–æ–∑–¥–∞–Ω —Å—Ç–æ–ª–±–µ—Ü —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º
# - –î—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã
# - –û–ø–µ—á–∞—Ç–∫–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã

# ## –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# –î–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—å–µ–¥–∏–Ω–∏–º –≤—Å–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü—É **customerID** –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–π –¥–∞–ª—å–Ω–µ–π—à–Ω–µ–π —Ä–∞–±–æ—Ç—ã.

# In[15]:


names = [contract, internet, personal, phone]
data = reduce(lambda left,right: pd.merge(left, right, on=['customerID']), names)


# <div class="alert alert-danger">
# <s><b>üòî –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</b> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 'outer' –∑–¥–µ—Å—å –∏–∑–ª–∏—à–Ω–µ, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∏—Ç–æ–≥ –Ω–µ –ø–æ–º–µ–Ω—è–µ—Ç—Å—è, –Ω–æ —Å –¥—Ä—É–≥–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏—Å–∫—É—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –ø—Ä–∏–¥–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</s>
# </div>

#   <div class="alert alert-info"> <b>üéì –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ü—Ä–∏–Ω—è–ª! –£–±—Ä–∞–ª outer.</div>

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
# </div>

# In[16]:


display(data.head())
print()
data.info()


# –ü–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—è–≤–∏–ª–∏—Å—å –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö.

# In[17]:


data.isna().sum()


# –ú—ã –≤–∏–¥–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ–ø—É—Å–∫–æ–≤. –†–∞–∑–±–µ—Ä–µ–º—Å—è —Å –Ω–∏–º–∏ –ø–æ–æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏. 
# 
# –°—Ç–æ–ª–±—Ü—ã —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø—Ä–æ–ø—É—Å–∫–æ–≤ 1526 - —ç—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –æ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –±—ã–ª–æ –Ω–∏–∫–∞–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ **Internet**. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –æ–Ω–∏ –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–¥–∫–ª—é—á–∏–ª–∏ –¥–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É. 
# 
# –ü—Ä–æ–ø—É—Å–∫–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ **MyltiplieLines** –≥–æ–≤–æ—Ä—è—Ç —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —É—Å–ª—É–≥–∞–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞. 
# 
# –ó–∞–º–µ–Ω–∏–º —ç—Ç–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–∞ —Ñ—Ä–∞–∑—ã **no_internet** –∏ **no_phone**.

# In[18]:


data['MultipleLines'].fillna('no_phone', inplace = True)

internet_columns = ['InternetService', 'OnlineSecurity', 'OnlineBackup', 
                   'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies']

for column in internet_columns:
    data[column].fillna('no_internet', inplace=True)


# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
# </div>

# In[19]:


data.isna().sum()


# –û—Ç–¥–µ–ª—å–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ **TotalCharges**.

# In[20]:


data[data['TotalCharges'].isna()]


# –î–∞—Ç—ã –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö **BeginDate** –∏ **EndDate** —Å–æ–≤–ø–∞–¥–∞—é—Ç. –ò–∑ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∞–±–æ–Ω–µ–Ω—Ç—ã –µ—â–µ –Ω–µ —É—Å–ø–µ–ª–∏ –æ–ø–ª–∞—Ç–∏—Ç—å —É—Å–ª—É–≥–∏, —Ç–∞–∫ –∫–∞–∫ –∑–∞–∫–ª—é—á–∏–ª–∏ –¥–æ–≥–æ–≤–æ—Ä –≤ –¥–µ–Ω—å —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –ó–∞–ø–æ–ª–Ω–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –µ–∂–µ–º–µ—Å—è—á–Ω—ã–º –ø–ª–∞—Ç–µ–∂–æ–º **MonthlyCharges**.

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ! –≠—Ç–æ –Ω–æ–≤—ã–µ –∞–±–æ–Ω–µ–Ω—Ç—ã!
# </div>

# In[21]:


data['TotalCharges'].fillna(data[data['TotalCharges'].isnull()]['MonthlyCharges'], inplace = True)


# –°–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü **period** —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–Ω–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–æ–π.

# In[22]:


data['period']=(data['EndDate']-data['BeginDate'])/np.timedelta64(1,'D')


# –ü—Ä–æ–≤–µ—Ä–∏–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

# In[23]:


data.info()


# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –û—Ç–ª–∏—á–Ω–æ, —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å!
# </div>

# –ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—Å–µ –ø—Ä–æ–ø—É—Å–∫–∏ –±—ã–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã, –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
# 
# –°–æ–∑–¥–∞–¥–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∫—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö.

# In[24]:


print('–ì–∏—Å—Ç–∞–≥—Ä–∞–º–º—ã –¥–ª—è –≤—Å–µ—Ö —á–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:\n')

# –ù–∞–π–¥–µ–º —á–∏—Å–ª–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ
numerical_columns = ['MonthlyCharges', 'TotalCharges','period']

# –ó–∞–¥–∞–¥–∏–º —Ä–∞–∑–º–µ—Ä —Ñ–∏–≥—É—Ä—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
plt.figure(figsize=(12, 8))

# –¶–∏–∫–ª –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —á–∏—Å–ª–æ–≤–æ–º—É —Å—Ç–æ–ª–±—Ü—É
for i, column in enumerate(numerical_columns):
    # –°–æ–∑–¥–∞–µ–º subplot –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
    plt.subplot(2, 3, i + 1)  # 2 —Å—Ç—Ä–æ–∫–∏, 3 —Å—Ç–æ–ª–±—Ü–∞, —Ç–µ–∫—É—â–∏–π –≥—Ä–∞—Ñ–∏–∫
    
    # –°—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
    data[column].hist(bins=50)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Å—Ç–æ–ª–±—Ü–∞
    plt.title(column)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∫–∏ –¥–ª—è –æ—Å–µ–π
    plt.xlabel(column)
    plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')

# –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
plt.tight_layout()
plt.show()


# In[25]:


print('–ö—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:\n')

# –°–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –∫—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
categorical_columns = [col for col in data.columns if col not in numerical_columns and col != 'BeginDate' and col != 'customerID' and col != 'EndDate']

# –ó–∞–¥–∞–¥–∏–º —Ä–∞–∑–º–µ—Ä —Ñ–∏–≥—É—Ä—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
plt.figure(figsize=(10, 10))

# –¶–∏–∫–ª –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Å—Ç–æ–ª–±—Ü—É
for i, column in enumerate(categorical_columns):
    # –°–æ–∑–¥–∞–µ–º subplot –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
    plt.subplot(6, 3, i + 1)  # 3 —Å—Ç—Ä–æ–∫–∏, 2 —Å—Ç–æ–ª–±—Ü–∞, —Ç–µ–∫—É—â–∏–π –≥—Ä–∞—Ñ–∏–∫
    
    # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–µ–∫—É—â–µ–º —Å—Ç–æ–ª–±—Ü–µ
    column_data = data[column].value_counts()
    
    # –°—Ç—Ä–æ–∏–º –∫—Ä—É–≥–æ–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
    plt.pie(column_data, labels=column_data.index, autopct='%1.1f%%')
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Å—Ç–æ–ª–±—Ü–∞
    plt.title(column)

# –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ –∫—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
plt.tight_layout()
plt.show()


# **–í—ã–≤–æ–¥—ã –ø–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö**
# 
# - –í –¥–∞–Ω–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.
# - –ú–µ—Å—è—á–Ω—ã–µ –æ–ø–ª–∞—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–ª–∞—Ç—è—Ç 20 –¥–æ–ª–ª–∞—Ä–æ–≤, –≤–∏–¥–∏–º–æ, —ç—Ç–æ —Ü–µ–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏.
# - –î–∞–ª—å—à–µ –ø–æ–º–µ—Å—è—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –±–æ–ª–µ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Å –ø–∏–∫–∞–º–∏ —Å—É–º–º 50, 60, 70, 80, 90, 100 –∏ 110 –¥–æ–ª–ª–∞—Ä–æ–≤.
# - –í –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ **period** –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–µ—Ä–≤—ã–π –≥–æ–¥, –±–æ–ª—å—à–µ. –û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–æ–π –±–æ–ª–µ–µ 5 —Å –ø–æ–ª–æ–≤–∏–Ω–æ–π –ª–µ—Ç.
# - –ß—É—Ç—å –±–æ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é **–ø–æ–º–µ—Å—è—á–Ω—É—é –æ–ø–ª–∞—Ç—É** –ø–æ–¥–ø–∏—Å–∫–∏.
# - –£ 21% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É—Å–ª—É–≥–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ. 
# - 16% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - —ç—Ç–æ –∂–∏—Ç–µ–ª–∏ –ø–µ–Ω—Å–∏–æ–Ω–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞.
# - **15% –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –ø—Ä–æ–¥–ª–∏–ª–∏ –ø–æ–¥–ø–∏—Å–∫—É**.

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
# </div>

# ## –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# –ü—Ä–æ–≤–µ–¥–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –∏ –æ—Ç–±–µ—Ä–µ–º —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é.
# 
# –°–Ω–∞—á–∞–ª–∞ —Å–¥–µ–ª–∞–µ–º –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã—Ö –∏ —É–±–µ—Ä–µ–º —Å—Ç–æ–ª–±–µ—Ü **customerID**, **EndDate** (—Ç–∞–∫ –∫–∞–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∏ target) –∏ **BeginDate** (—Ç–∞–∫ –∫–∞–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∏ period).

# In[26]:


data_corr = data.copy()
data_corr = data_corr.drop(columns=['customerID', 'EndDate', 'BeginDate'])


# –ü–æ—Å—Ç—Ä–æ–∏–º –º–∞—Ç—Ä–∏—Ü—É –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ phik.

# In[27]:


phik_overview = data_corr.phik_matrix()
phik_overview.round(2)


# In[28]:


interval_cols = ['MonthlyCharges', 'TotalCharges', 'period']

phik_overview = data_corr.phik_matrix(interval_cols = interval_cols)


# In[29]:


plot_correlation_matrix(phik_overview.values, 
                       x_labels = phik_overview.columns,
                       y_labels = phik_overview.index,
                       vmin = 0,
                       vmax = 1,
                       title = r'–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ $\phi_k$',
                       color_map= "Greens",
                       fontsize_factor = 1.5,
                       figsize = (20, 12))
plt.show();


# –ú—ã –±–æ–ª–µ–µ –æ—Ç—á–µ—Ç–ª–∏–≤–æ –≤–∏–¥–∏–º, –∫–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤–ª–∏—è—é—Ç –Ω–∞ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é. –û–¥–Ω–∞–∫–æ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç —Å–ª–∞–±—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å **target**.
# 
# –í –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –æ—Ç–±–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –±–æ–ª—å—à–µ 0.1.

# In[30]:


data1 = data_corr.drop(columns=['Dependents','SeniorCitizen','gender', 'StreamingMovies', 'StreamingTV','TechSupport', 'DeviceProtection', 'OnlineBackup', 'OnlineSecurity', 'InternetService', 'PaperlessBilling', 'Type'])


# In[31]:


data1.head()


# In[32]:


phik_overview = data1.phik_matrix(interval_cols = interval_cols)
plot_correlation_matrix(phik_overview.values, 
                       x_labels = phik_overview.columns,
                       y_labels = phik_overview.index,
                       vmin = 0,
                       vmax = 1,
                       title = r'–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ $\phi_k$',
                       color_map= "Greens",
                       fontsize_factor = 1.5,
                       figsize = (20, 12))
plt.show();


# –ú—ã —É–¥–∞–ª–∏–ª–∏ —Ç–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–∫–∞–∑—ã–≤–∞–ª–∏ –º–µ–Ω—å—à–µ –≤—Å–µ–≥–æ –≤–ª–∏—è–Ω–∏—è –∏ –æ—Å—Ç–∞–≤–∏–ª–∏ –±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã–µ, —É—á–∏—Ç—ã–≤–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º. –ù–∞–∏–±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:
# - —Å—Ä–æ–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ - **period**.
# - —Å–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç –ø–æ—Ç—Ä–∞—Ç–∏–ª –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É - **TotalCharges**.
# 
# –ß–µ–º –¥–æ–ª—å—à–µ –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ —á–µ–º –±–æ–ª—å—à–µ –æ–Ω –∑–∞–ø–ª–∞—Ç–∏–ª –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è, —Ç–µ–º –º–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫–∞–∂–µ—Ç—Å—è –æ—Ç –ø—Ä–æ–¥–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏.

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –ü—Ä–∏–∑–Ω–∞–∫–∏ –æ—Ç–æ–±—Ä–∞–Ω—ã!
# </div>

# ## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

# –í—ã–¥–µ–ª–∏–º –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ data1 —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫.

# In[33]:


X = data1.drop('target', axis = 1)
y = data1['target']


# –í—ã–≤–µ–¥–µ–º —Ä–∞–∑–º–µ—Ä—ã –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.

# In[34]:


X.shape, y.shape


# –°—Ñ–æ—Ä–º–∏—Ä—É–µ–º –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –≤—ã–±–æ—Ä–∫–∏.

# In[35]:


X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size = TEST_SIZE,
    random_state = RANDOM_STATE,
    stratify = y)


# –ü—Ä–æ–≤–µ—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤.

# In[36]:


print('–†–∞—Å—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:', y_train.value_counts(normalize = True))
print()
print('–†–∞—Å—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:', y_test.value_counts(normalize = True))


# –°–æ–∑–¥–∞–¥–∏–º —Å–ø–∏—Å–∫–∏ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è.

# In[37]:


num_columns = X_train.select_dtypes(include=['float64','int64']).columns.tolist()
num_columns


# In[38]:


cat_columns = X_train.select_dtypes(include=['object']).columns.tolist()
for column in cat_columns:
        unique_values = X_train[column].unique()
        print(f"–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å—Ç–æ–ª–±—Ü–∞ '{column}': {unique_values}")


# In[39]:


# –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è OneHotEncoder
ohe_columns = ['PaymentMethod', 'Partner', 'MultipleLines']

# —á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
num_columns = ['MonthlyCharges', 'TotalCharges', 'period']


# –°–æ–∑–¥–∞–¥–∏–º –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ ohe_columns.

# In[40]:


ohe_pipe = Pipeline([
        (
            'simpleImputer_ohe', 
            SimpleImputer(missing_values=np.nan, strategy='most_frequent')
        ),
        (    'ohe', 
            OneHotEncoder(sparse_output=False, handle_unknown='error',drop='first')
        )
])


# –°–æ–∑–¥–∞–¥–∏–º –æ–±—â–∏–π –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

# In[41]:


data_preprocessor = ColumnTransformer(
    [
        ('ohe', ohe_pipe, ohe_columns),
        ('num', MinMaxScaler(), num_columns)   
    ], 
    remainder =  'passthrough'
)
print(data_preprocessor)


# –°–æ–∑–¥–∞–¥–∏–º –∏—Ç–æ–≥–æ–≤—ã–π –ø–∞–π–ø–ª–∞–π–Ω.

# In[42]:


pipe_final= Pipeline(
    [
        ('preprocessor', data_preprocessor),
        ('models', DecisionTreeRegressor(random_state=RANDOM_STATE))
    ]
)


# –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –µ–≥–æ.

# In[43]:


pipe_final


# –°–æ–∑–¥–∞–¥–∏–º —Å–ª–æ–≤–∞—Ä–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π: DecisionTreeClassifier, SVC, LogisticRegression.

# In[44]:


param_distributions = [
    # —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –º–æ–¥–µ–ª–∏ DecisionTreeClassifier()
    {
        'models': [DecisionTreeClassifier(random_state=RANDOM_STATE)],
        'models__max_depth': range(2, 7),
        'models__max_features': range(2, 20),
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough'],
        'models__min_samples_split': range(2,20) ,
        'models__min_samples_leaf': range(2,20) ,
    },
    # —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –º–æ–¥–µ–ª–∏ SVC()
    {
        'models': [SVC(random_state=RANDOM_STATE, probability = True)],
        'models__kernel':('rbf','linear','poly'),
        'models__C': range(1,100),
        'models__degree': range(1,10),
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']  

    },
    # —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –º–æ–¥–µ–ª–∏ LogisticRegression()
    {
        'models': [LogisticRegression(random_state=RANDOM_STATE)],
        'models__solver': ('liblinear', 'saga', 'lbfgs'),
        'models__penalty': ('l1', 'l2', 'elasticnet', 'none'),
        'models__C': range(1,100),
        
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']  
    }

] 


# In[45]:


randomized_search = RandomizedSearchCV(
    pipe_final, 
    param_distributions, 
    cv=5,
    scoring='roc_auc',
    random_state=RANDOM_STATE,
    n_jobs=-1
    
)


# In[46]:


le = LabelEncoder()
y_train = le.fit_transform(y_train)
y_train


# –û–±—É—á–∏–º –º–æ–¥–µ–ª—å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ.

# In[47]:


randomized_search.fit(X_train, y_train)


# In[48]:


print('–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\n\n', randomized_search.best_estimator_)
print ('–ú–µ—Ç—Ä–∏–∫–∞ ROC_AUC –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:', randomized_search.best_score_)


# –ú—ã –ø–æ–ª—É—á–∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å - **DecisionTreeClassifier** —Å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ **(max_depth=4, max_features=16, min_samples_leaf=4, min_samples_split=8, random_state=80925)**. –ï—ë –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –º–µ—Ç—Ä–∏–∫–∏ **roc_auc - 0.75**, —á—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–∞–ª–æ –∏ –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π —Ü–µ–ª–∏.
# 
# –ù–∞–ø–∏—à–µ–º –µ—â–µ –æ–¥–∏–Ω –ø–∞–π–ø–ª–∞–π–Ω –ø–æ –ø–æ–¥–±–æ—Ä—É –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏ CatBoostClassifier.

# In[51]:


pipeline_CB = Pipeline([('scaler', data_preprocessor),('model', CatBoostClassifier(iterations=100, learning_rate=0.1))])

param_grid = [
                {
                'model': [CatBoostClassifier(random_state=RANDOM_STATE, verbose=0)],
                'model__learning_rate': [0.01, 0.03],
                'model__depth': range(2, 8, 1)
                }]

CB_CV = GridSearchCV(pipeline_CB,
                    param_grid,
                    cv = 5,
                    scoring='roc_auc',
                    n_jobs=-1,
                    verbose=1)

CB_CV.fit(X_train, y_train)


# In[52]:


print('–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\n\n', CB_CV.best_estimator_)
print ('–ú–µ—Ç—Ä–∏–∫–∞ ROC_AUC –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:', CB_CV.best_score_)


# –ó–¥–µ—Å—å –ª—É—á—à–µ –≤—Å–µ—Ö —Å–µ–±—è –ø–æ–∫–∞–∑–∞–ª–∞ –º–æ–¥–µ–ª—å **CatBoostClassifier**. –ï—ë –º–µ—Ç—Ä–∏–∫–∞ **roc_auc - 0.85**. 
# 
# –ë—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –≤—ã–±—Ä–∞–Ω–∞!
# </div>

# In[53]:


y_test_probas = CB_CV.predict_proba(X_test)[:,1]
y_test_probas


# In[54]:


print(y_test.shape)
y_test_probas.shape


# –í—ã–≤–µ–¥–µ–º –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

# In[55]:


CB_CV.best_params_


# In[56]:


print(f'–ú–µ—Ç—Ä–∏–∫–∞ ROC-AUC –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: {roc_auc_score(y_test, y_test_probas)}')


# –ú—ã –ø–æ–ª—É—á–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ **roc_auc 0.91** (–Ω–∞—à–∞ —Ü–µ–ª—å >= 0.85). –î–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å –∑–∞–¥–∞—á–µ–π —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è.
# 
# 
# –í—ã–≤–µ–¥–µ–º –º–∞—Ç—Ä–∏—Ü—É –æ—à–∏–±–æ–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ 1 –∏ 2 —Ä–æ–¥–∞.

# In[57]:


y_test_pred = CB_CV.predict(X_test)
cm = confusion_matrix(y_test, y_test_pred)
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues_r')
plt.ylabel('True label')
plt.xlabel('Predicted'); 


# - –£ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å –¥–æ–≤–æ–ª—å–Ω–æ –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (Accuracy), —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∞ —Ö–æ—Ä–æ—à–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ. 
# - –û–¥–Ω–∞–∫–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å Recall –¥–ª—è –∫–ª–∞—Å—Å–∞ 1 –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∞—è, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –º–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–ª–∞—Å—Å–∞ 1 –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ö –∫–∞–∫ –∫–ª–∞—Å—Å 0. –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å–∞, –Ω–æ –≤ —Ü–µ–ª–æ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–æ–≤–æ–ª—å–Ω–æ —Ç–æ—á–Ω—ã–µ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤.
# 
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç –Ω–∞–¥ –æ—à–∏–±–æ—á–Ω—ã–º–∏: 1478 True Negative, 156 True Positive.

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
# </div>

# In[61]:


fig, ax = plt.subplots(figsize=(10, 6))

RocCurveDisplay.from_estimator(
    CB_CV,           
    X_test,          
    y_test,          
    ax=ax,
    name='CatBoost'  
)

ax.plot([0, 1], [0, 1], linestyle='--', color='gray', label='Random classifier')

ax.set_title('ROC-–∫—Ä–∏–≤–∞—è', fontsize=16)
ax.set_xlabel('False Positive Rate', fontsize=12)
ax.set_ylabel('True Positive Rate', fontsize=12)
ax.legend(loc='lower right')
ax.grid(True, alpha=0.3)

plt.show()


# –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º, –∫–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ–≤–ª–∏—è–ª–∏ –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ.

# In[ ]:


X_train.columns


# In[ ]:


best_model = CB_CV.best_estimator_
model = best_model.named_steps['model']

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –∏—Ö –∏–º–µ–Ω
feature_importances = model.get_feature_importance()

# –ò–∑–≤–ª–µ–∫–∞–µ–º —à–∞–≥–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
data_preprocessor = best_model.named_steps['scaler']

# –ü–æ–ª—É—á–∞–µ–º –∏–º–µ–Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
transformed_feature_names = data_preprocessor.get_feature_names_out()

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
feature_importance_df = pd.DataFrame({
    '–ü—Ä–∏–∑–Ω–∞–∫': transformed_feature_names,
    '–í–∞–∂–Ω–æ—Å—Ç—å': feature_importances
})

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
feature_importance_df = feature_importance_df.sort_values(by='–í–∞–∂–Ω–æ—Å—Ç—å', ascending=False)

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
plt.figure(figsize=(12, 8))
sns.barplot(x='–í–∞–∂–Ω–æ—Å—Ç—å', y='–ü—Ä–∏–∑–Ω–∞–∫', data=feature_importance_df)
plt.title('–í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏ CatBoostClassifier')
plt.show()


# <div class="alert alert-danger">
#     <s><b>üòî –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</b> –ó–∞—á–µ–º –∑–¥–µ—Å—å –µ—â–µ —Ä–∞–∑ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è pandas?</s>
# </div>

#   <div class="alert alert-info"> <b>üéì –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.</div>

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
# </div>

# –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –º–æ–∂–Ω–æ –Ω–∞–≥–ª—è–¥–Ω–æ —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–≤–ª–∏—è–ª–∏ –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —ç—Ç–æ:
# 
# - period - –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ—à–ª–æ —Å –¥–∞—Ç—ã –∑–∞–∫–ª—é—á–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞
# - TotalCharges - –æ–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã –∞–±–æ–Ω–µ–Ω—Ç–∞ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è
# - MonthlyCharges - —Ä–∞–∑–º–µ—Ä –µ–∂–µ–º–µ—Å—è—á–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ –∞–±–æ–Ω–µ–Ω—Ç–∞
# - Partner - –Ω–∞–ª–∏—á–∏–µ —Å—É–ø—Ä—É–≥–∞(–∏) —É –∞–±–æ–Ω–µ–Ω—Ç–∞
# 
# –≠—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∑–∞–º–µ—Ç–Ω–æ —Å–∞–º—ã–µ –≤–µ—Å–æ–º—ã–µ –∏ –≤–∞–∂–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö. –í–µ—Å–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ. 

# <div class="alert alert-danger">
#     <s><b>üòî –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</b> –ù—É–∂–Ω–æ –µ—â–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å ROC-–∫—Ä–∏–≤—É—é</s>
# </div>

#   <div class="alert alert-info"> <b>üéì –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –î–æ–±–∞–≤–∏–ª –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é roc-–∫—Ä–∏–≤–æ–π.</div>

# ## –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥

# **–í—ã–≤–æ–¥—ã –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö**
# 
# - –î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
# - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —á–∏—Å–ª–∞ –∏ –¥–∞—Ç—ã –∑–∞–ø–∏—Å–∞–Ω—ã —Ç–∏–ø–æ–º object (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∏—Ç—å)
# - –ë—É–ª–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã —Å–ª–æ–≤–∞–º–∏ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π)
# - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö
# - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–æ–ª–±–µ—Ü —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å) 
# 
# **–í—ã–≤–æ–¥—ã –ø–æ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö**
# 
# - –ß–∏—Å–ª–∞ –∏ –¥–∞—Ç—ã –±—ã–ª–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ –Ω—É–∂–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö
# - –°–æ–∑–¥–∞–Ω —Å—Ç–æ–ª–±–µ—Ü —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º
# - –î—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã
# - –û–ø–µ—á–∞—Ç–∫–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã
# 
# **–í—ã–≤–æ–¥—ã –ø–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö**
# 
# - –í –¥–∞–Ω–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.
# - –ú–µ—Å—è—á–Ω—ã–µ –æ–ø–ª–∞—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–ª–∞—Ç—è—Ç 20 –¥–æ–ª–ª–∞—Ä–æ–≤, –≤–∏–¥–∏–º–æ, —ç—Ç–æ —Ü–µ–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏.
# - –î–∞–ª—å—à–µ –ø–æ–º–µ—Å—è—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –±–æ–ª–µ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Å –ø–∏–∫–∞–º–∏ —Å—É–º–º 50, 60, 70, 80, 90, 100 –∏ 110 –¥–æ–ª–ª–∞—Ä–æ–≤.
# - –í –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ **period** –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–µ—Ä–≤—ã–π –≥–æ–¥, –±–æ–ª—å—à–µ. –û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–æ–π –±–æ–ª–µ–µ 5 —Å –ø–æ–ª–æ–≤–∏–Ω–æ–π –ª–µ—Ç.
# - –ß—É—Ç—å –±–æ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é **–ø–æ–º–µ—Å—è—á–Ω—É—é –æ–ø–ª–∞—Ç—É** –ø–æ–¥–ø–∏—Å–∫–∏.
# - –£ 21% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É—Å–ª—É–≥–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ. 
# - 16% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - —ç—Ç–æ –∂–∏—Ç–µ–ª–∏ –ø–µ–Ω—Å–∏–æ–Ω–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞.
# - **15% –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –ø—Ä–æ–¥–ª–∏–ª–∏ –ø–æ–¥–ø–∏—Å–∫—É**.
# 
# –ù–∞–∏–±–æ–ª—å—à–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:
# - —Å—Ä–æ–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ - **period**.
# - —Å–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç –ø–æ—Ç—Ä–∞—Ç–∏–ª –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É - **TotalCharges**.
# 
# –ß–µ–º –¥–æ–ª—å—à–µ –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ —á–µ–º –±–æ–ª—å—à–µ –æ–Ω –∑–∞–ø–ª–∞—Ç–∏–ª –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è, —Ç–µ–º –º–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫–∞–∂–µ—Ç—Å—è –æ—Ç –ø—Ä–æ–¥–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏.
# 
# **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏**
# 
# –í —Ö–æ–¥–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –º–æ–¥–µ–ª–∏: DecisionTreeClassifier, SVC, LogisticRegression, CatBoostClassifier.
# 
# –õ—É—á—à–µ –≤—Å–µ—Ö —Å–µ–±—è –ø–æ–∫–∞–∑–∞–ª–∞ –º–æ–¥–µ–ª—å **CatBoostClassifier** —Å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ **('model__depth': 5, 'model__learning_rate': 0.03)**. –ï—ë –º–µ—Ç—Ä–∏–∫–∞ **roc_auc** –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ —Å–æ—Å—Ç–∞–≤–∏–ª–∞ **0.85**. –ê –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π - **0.91**.
# - –£ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å –¥–æ–≤–æ–ª—å–Ω–æ –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (Accuracy), —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∞ —Ö–æ—Ä–æ—à–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ. 
# - –û–¥–Ω–∞–∫–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å Recall –¥–ª—è –∫–ª–∞—Å—Å–∞ 1 –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∞—è, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –º–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–ª–∞—Å—Å–∞ 1 –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ö –∫–∞–∫ –∫–ª–∞—Å—Å 0. –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å–∞, –Ω–æ –≤ —Ü–µ–ª–æ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–æ–≤–æ–ª—å–Ω–æ —Ç–æ—á–Ω—ã–µ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤.
# 
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç –Ω–∞–¥ –æ—à–∏–±–æ—á–Ω—ã–º–∏: 1478 True Negative, 156 True Positive.
# 
# –°–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–≤–ª–∏—è–ª–∏ –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —ç—Ç–æ:
# 
# - period - –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ—à–ª–æ —Å –¥–∞—Ç—ã –∑–∞–∫–ª—é—á–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞
# - TotalCharges - –æ–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã –∞–±–æ–Ω–µ–Ω—Ç–∞ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è
# - MonthlyCharges - —Ä–∞–∑–º–µ—Ä –µ–∂–µ–º–µ—Å—è—á–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ –∞–±–æ–Ω–µ–Ω—Ç–∞
# - Partner - –Ω–∞–ª–∏—á–∏–µ —Å—É–ø—Ä—É–≥–∞(–∏) —É –∞–±–æ–Ω–µ–Ω—Ç–∞
# 
# **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞**
# 
# –ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤, –º–æ–∂–Ω–æ –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:
# 
# *–§–æ–∫—É—Å –Ω–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤*
# 
# - –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å–æ —Å—Ç–∞–∂–µ–º –±–æ–ª–µ–µ 5 –ª–µ—Ç
# - –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏ –±–æ–Ω—É—Å—ã –¥–ª—è –¥–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
# 
# *–£–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤*
# 
# - –£—Å–∏–ª–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –ø–µ—Ä–≤—ã–π –≥–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å–ª—É–≥–∏
# 
# *–£–ª—É—á—à–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —Å–µ–º–µ–π–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤*
# 
# - –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–µ–º–µ–π–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –∏ –∞–∫—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–ª–∏—á–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏

# <div class="alert alert-warning">
# <b>ü§î –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</b> –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤, –≤ —Ü–µ–ª–æ–º –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç!
# </div>

#   <div class="alert alert-info"> <b>üéì –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –°–≤–µ—Ç–ª–∞–Ω–∞, –µ—â—ë —Ä–∞–∑ —Å–ø–∞—Å–∏–±–æ –∑–∞ —Ä–µ–≤—å—é –º–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –ü–æ—Å—Ç–∞—Ä–∞–ª—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –∑–∞–º–µ—á–∞–Ω–∏—è.</div>

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –ú–æ–ª–æ–¥–µ—Ü, —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –°–∞–º–∞ —Ä–∞–±–æ—Ç–∞ –ø–æ–ª—É—á–∏–ª–∞—Å—å —Ö–æ—Ä–æ—à–µ–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π, –±—ã–ª–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ, –≤—ã–±—Ä–∞–Ω —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫, —Ä–∞—Å—Å—á–µ—Ç—ã –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π, —ç—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã, –∫–æ—Ç–æ—Ä–∞—è –æ–±–ª–µ–≥—á–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª–Ω–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–µ –≤ –¥–∞–Ω–Ω—ã—Ö. –ü–æ—Å—Ç—Ä–æ–µ–Ω–æ –∏ –æ–±—É—á–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π, –≤—Å–µ –æ–Ω–∏ –æ—Ü–µ–Ω–µ–Ω—ã –∏ –≤—ã–±—Ä–∞–Ω–∞ –ª—É—á—à–∞—è. –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞, –ø–æ–ª—É—á–µ–Ω–∞ –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â–∞—è —É—Ö–æ–¥ –∫–ª–∏–µ–Ω—Ç–æ–≤. –ù–µ –∑–∞–±—ã–≤–∞–π –æ —Ç–æ–º, —á—Ç–æ –≤—Å–µ –ø—É–Ω–∫—Ç—ã –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã –∏ –∫–∞–∂–¥–æ–º—É —Å—Ç–æ–∏—Ç —É–¥–µ–ª—è—Ç—å –º–∞–∫—Å–∏–º—É–º –≤–Ω–∏–º–∞–Ω–∏—è. <p>
# –° –æ–ø—ã—Ç–æ–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª–µ–≥—á–µ, –Ω–æ –æ–ø—ã—Ç —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –æ–¥–Ω–∞–∂–¥—ã –∏–∑—É—á–µ–Ω–Ω–æ–≥–æ, –Ω–æ –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ, —Ç–µ–º –±–æ–ª–µ–µ, —á—Ç–æ —Ç—ã –≤—ã–±—Ä–∞–ª –æ—á–µ–Ω—å –¥–∏–Ω–∞–º–∏—á–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—é—â—É—é—Å—è –æ–±–ª–∞—Å—Ç—å. <p>
# –í –±—É–¥—É—â–µ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ —Ç–µ–±–µ —Ç–æ—á–Ω–æ –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è —É–º–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –∫ —Ä–µ—à–µ–Ω–∏—é –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á, –∑–¥–µ—Å—å —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏–∑—É—á–∏—Ç—å –¢–†–ò–ó –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑, –∏–∑ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∏–Ω–∏–º—É–º –ø–æ Big Data ‚Äî –°—É –ö–µ–Ω–Ω–µ—Ç –∏ –´–Ω –ê–Ω–Ω–∞–ª–∏–Ω, –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ Data Science ‚Äî –ë—Ä—é—Å –ü. –∏ –ë—Ä—é—Å –≠., Real-World Machine Learning ‚Äî Henric Brink, Joseph –úark, W. Richards Fetherolf, –ü—Ä–∏–∫–ª–∞–¥–Ω–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Scikit-Learn –∏ TensorFlow ‚Äî –ñ–µ—Ä–æ–Ω –û—Ä–µ–ª—å–µ–Ω.<p>
# –ï—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä https://vk.com/mashinnoe_obuchenie_ai_big_data) –∏ –∫–æ–Ω–µ—á–Ω–æ –∂–µ https://habr.com/ru/all/<p>
# 
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å:
# - –ö–Ω–∏–≥–∞ –æ—Ç –®–ê–î: https://academy.yandex.ru/handbook/ml
# 
# - –û—Ç–∫—Ä—ã—Ç—ã–π –∫—É—Ä—Å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è: https://habr.com/ru/company/ods/blog/322626/
# 
#  –£–¥–∞—á–∏ —Ç–µ–±–µ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞!
# </div>

# In[ ]:




